(()=>{"use strict";const e=e=>document.querySelector(e);function t(t,a){const s=function(e,t=[]){const a=document.createElement(e);return t.forEach((e=>a.classList.add(e))),a}("div",["alert",`alert-${(".alert",document.querySelectorAll(".alert")).length+1}`]);s.innerHTML=t,s.classList.add(a);const n=e("#page-wrapper");document.body.insertBefore(s,n),setTimeout((()=>s.classList.add("active")),100),setTimeout((()=>s.classList.remove("active")),2e3),setTimeout((()=>s.remove()),2100)}const a=e("#pwd-change-form"),s=e("#pwd0"),n=e("#pwd1"),o=e("#pwd2");let d=!1,r=!1;n.addEventListener("keyup",(()=>{!function(e){const t=/\d+/.test(e),a=e.length>=8,s=/\W+/.test(e),n=/\s+/.test(e),o=/[A-Z]/.test(e),d=/[a-z]/.test(e);return t&&a&&s&&!n&&o&&d}(n.value)?(d=!1,n.setCustomValidity("Mot de passe faible")):(d=!0,n.setCustomValidity(""))})),o.addEventListener("keyup",(()=>{n.value===o.value?(o.setCustomValidity(""),r=!0):(o.setCustomValidity("Les mots de passe ne correspondent pas"),r=!1)})),a.addEventListener("submit",(e=>{e.preventDefault(),d&&r?fetch("/submit/change-password",{method:"post",body:new FormData(a)}).then((e=>e.json())).then((e=>t(e.msg,e.error?"invalid":"valid"))).then((()=>{s.value="",n.value="",o.value=""})):t(r?"Votre nouveau mot de passe n’est pas assez fort":"Les mots de passe donnés sont différents !","invalid")}));const m=e("form[data-role=user-options]"),u=new BroadcastChannel("display-options");m.addEventListener("change",(e=>{"mode"===e.target.name?(document.documentElement.dataset.mode=e.target.value,document.documentElement.dataset.preset=e.target.value):"style"===e.target.name?"compact"===e.target.value?document.body.classList.add("compact"):document.body.classList.remove("compact"):"theme"===e.target.name&&(document.documentElement.dataset.theme=e.target.value);const a=new FormData;a.append("option",e.target.name),a.append("value",e.target.value),fetch("/submit/set-user-option",{method:"post",body:a}).then((()=>t("Préférences modifiées","valid"))).then((()=>u.postMessage({option:e.target.name,value:e.target.value})))}))})();