(()=>{"use strict";function e(e){return document.querySelector(e)}function t(e){return document.querySelectorAll(e)}var n,r="undefined"==typeof document?void 0:document,a=!!r&&"content"in r.createElement("template"),i=!!r&&r.createRange&&"createContextualFragment"in r.createRange();function o(e,t){var n,r,a=e.nodeName,i=t.nodeName;return a===i||(n=a.charCodeAt(0),r=i.charCodeAt(0),n<=90&&r>=97?a===i.toUpperCase():r<=90&&n>=97&&i===a.toUpperCase())}function d(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var l={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}d(e,t,"selected")},INPUT:function(e,t){d(e,t,"checked"),d(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var a=r.nodeValue;if(a==n||!n&&a==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,a=-1,i=0,o=e.firstChild;o;)if("OPTGROUP"===(r=o.nodeName&&o.nodeName.toUpperCase()))o=(n=o).firstChild;else{if("OPTION"===r){if(o.hasAttribute("selected")){a=i;break}i++}!(o=o.nextSibling)&&n&&(o=n.nextSibling,n=null)}e.selectedIndex=a}}};function s(){}function u(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}const c=function(e,t,d){if(d||(d={}),"string"==typeof t)if("#document"===e.nodeName||"HTML"===e.nodeName||"BODY"===e.nodeName){var c=t;(t=r.createElement("html")).innerHTML=c}else f=(f=t).trim(),t=a?function(e){var t=r.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(f):i?function(e){return n||(n=r.createRange()).selectNode(r.body),n.createContextualFragment(e).childNodes[0]}(f):function(e){var t=r.createElement("body");return t.innerHTML=e,t.childNodes[0]}(f);else 11===t.nodeType&&(t=t.firstElementChild);var f,m=d.getNodeKey||u,p=d.onBeforeNodeAdded||s,v=d.onNodeAdded||s,h=d.onBeforeElUpdated||s,N=d.onElUpdated||s,g=d.onBeforeNodeDiscarded||s,b=d.onNodeDiscarded||s,C=d.onBeforeElChildrenUpdated||s,y=d.skipFromChildren||s,E=d.addChild||function(e,t){return e.appendChild(t)},A=!0===d.childrenOnly,S=Object.create(null),T=[];function x(e){T.push(e)}function L(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var r=void 0;t&&(r=m(n))?x(r):(b(n),n.firstChild&&L(n,t)),n=n.nextSibling}}function w(e,t,n){!1!==g(e)&&(t&&t.removeChild(e),b(e),L(e,n))}function U(e){v(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=m(t);if(r){var a=S[r];a&&o(t,a)?(t.parentNode.replaceChild(a,t),O(a,t)):U(t)}else U(t);t=n}}function O(e,t,n){var a=m(t);if(a&&delete S[a],!n){if(!1===h(e,t))return;if(function(e,t){var n,r,a,i,o=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var d=o.length-1;d>=0;d--)r=(n=o[d]).name,a=n.namespaceURI,i=n.value,a?(r=n.localName||r,e.getAttributeNS(a,r)!==i&&("xmlns"===n.prefix&&(r=n.name),e.setAttributeNS(a,r,i))):e.getAttribute(r)!==i&&e.setAttribute(r,i);for(var l=e.attributes,s=l.length-1;s>=0;s--)r=(n=l[s]).name,(a=n.namespaceURI)?(r=n.localName||r,t.hasAttributeNS(a,r)||e.removeAttributeNS(a,r)):t.hasAttribute(r)||e.removeAttribute(r)}}(e,t),N(e),!1===C(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var n,a,i,d,s,u=y(e,t),c=t.firstChild,f=e.firstChild;e:for(;c;){for(d=c.nextSibling,n=m(c);!u&&f;){if(i=f.nextSibling,c.isSameNode&&c.isSameNode(f)){c=d,f=i;continue e}a=m(f);var v=f.nodeType,h=void 0;if(v===c.nodeType&&(1===v?(n?n!==a&&((s=S[n])?i===s?h=!1:(e.insertBefore(s,f),a?x(a):w(f,e,!0),a=m(f=s)):h=!1):a&&(h=!1),(h=!1!==h&&o(f,c))&&O(f,c)):3!==v&&8!=v||(h=!0,f.nodeValue!==c.nodeValue&&(f.nodeValue=c.nodeValue))),h){c=d,f=i;continue e}a?x(a):w(f,e,!0),f=i}if(n&&(s=S[n])&&o(s,c))u||E(e,s),O(s,c);else{var N=p(c);!1!==N&&(N&&(c=N),c.actualize&&(c=c.actualize(e.ownerDocument||r)),E(e,c),U(c))}c=d,f=i}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=m(t))?x(n):w(t,e,!0),t=r}}(e,f,a);var g=l[e.nodeName];g&&g(e,t)}(e,t):l.TEXTAREA(e,t)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var r=m(n);r&&(S[r]=n),e(n),n=n.nextSibling}}(e);var D,R,I=e,P=I.nodeType,V=t.nodeType;if(!A)if(1===P)1===V?o(e,t)||(b(e),I=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(e,(D=t.nodeName,(R=t.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==R?r.createElementNS(R,D):r.createElement(D)))):I=t;else if(3===P||8===P){if(V===P)return I.nodeValue!==t.nodeValue&&(I.nodeValue=t.nodeValue),I;I=t}if(I===t)b(e);else{if(t.isSameNode&&t.isSameNode(I))return;if(O(I,t,A),T)for(var k=0,q=T.length;k<q;k++){var B=S[T[k]];B&&w(B,B.parentNode,!1)}}return!A&&I!==e&&e.parentNode&&(I.actualize&&(I=I.actualize(e.ownerDocument||r)),e.parentNode.replaceChild(I,e)),I},f=e("[data-role=filter-form]"),m=t("[name=affichage]"),p=e("[data-role=range-filter]"),v=t("[data-role=origin-selector]"),h=e("[name=keyword]");let N;function g(){const e=t("[data-role=spells-wrapper] .liste"),n=[];v.length?v.forEach((e=>{e.checked&&n.push(e.value)})):n.push("RdB");const r=p.value.split("-"),a=parseInt(r[0]),i=parseInt(r[1]||a);a>i&&([a,i]=[i,a]);const o=h?h.value:"";e.forEach((e=>{const t=E(e.querySelector("summary div:first-of-type").textContent,o)||o.length<=2;e.dataset.nivMin>i||e.dataset.nivMax<a||!n.includes(e.dataset.origin)||!t?e.classList.add("hidden"):e.classList.remove("hidden")})),y()}function b(){if(!h)return;const e=t("[data-role=skills-wrapper] .liste"),n=h.value;e.forEach((e=>{E(e.querySelector("summary").textContent,n)||n.length<=2?e.classList.remove("hidden"):e.classList.add("hidden")})),y()}function C(){if(!h)return;const e=t("[data-role=avdesavs-wrapper] .liste"),n=h.value;e.forEach((e=>{E(e.querySelector("summary").textContent,n)||n.length<=2?e.classList.remove("hidden"):e.classList.add("hidden")})),y()}function y(){t(":is([data-role=avdesavs-wrapper], [data-role=skills-wrapper], [data-role=spells-wrapper]) details:not(.liste)").forEach((e=>{e.querySelectorAll(".liste:not(.hidden)").length?e.classList.remove("hidden"):e.classList.add("hidden")}))}function E(e,t){const n=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(n)}f.addEventListener("submit",(e=>e.preventDefault())),m.forEach((e=>{e.addEventListener("change",(t=>{const n=new FormData;n.append("affichage",e.value),fetch(f.action,{method:"POST",body:n}).then((e=>e.text())).then((e=>{var t,n;t="main",n=e,new Promise(((e,r)=>{try{const r=(new DOMParser).parseFromString(n,"text/html").querySelector(t),a=document.querySelector(t);c(a,r,{onBeforeElUpdated:function(e,t){if("DETAILS"===e.tagName&&e.id===t.id&&(t.open=e.open),"ignore"===e.dataset.morphdom)return!1}}),e("DOM updated successfully")}catch(e){r(e)}})),g(),b(),C()}))}))})),p.addEventListener("keyup",(e=>{N&&clearTimeout(N),N=setTimeout(g,500)})),v.forEach((e=>{e.addEventListener("change",(e=>{g()}))})),h&&h.addEventListener("keyup",(e=>{g(),b(),C()}))})();