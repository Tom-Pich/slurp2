(()=>{"use strict";var __webpack_modules__={771:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function qs(e){return document.querySelector(e)}function qsa(e){return document.querySelectorAll(e)}function ce(e,t=[]){const n=document.createElement(e);return t.forEach((e=>n.classList.add(e))),n}function checkPasswordStrength(e){const t=/\d+/.test(e),n=e.length>=8,r=/\W+/.test(e),a=/\s+/.test(e),i=/[A-Z]/.test(e),o=/[a-z]/.test(e);return t&&n&&r&&!a&&i&&o}function calculate(str){if(null===str)return"";let result;str=str.replace(/[+-]+$/g,""),str=str.replace(/[^-\(\)\d/\*+\.]/g,"");try{result=eval(str)}catch(e){result=""}return result=void 0===result?"":result,result}function int(e){return isNaN(parseInt(e))?0:parseInt(e)}function coarseRound(e){let t=!1;return e<0&&(e*=-1,t=!0),e=e<50?Math.round(e):e<200?5*Math.round(e/5):e<500?10*Math.round(e/10):e<2e3?50*Math.round(e/50):100*Math.round(e/100),t&&(e*=-1),e}function trimModifier(e){return(e=e.replace(/\([+-]\d+\)$/g,"")).trimEnd()}function explicitSign(e){return e>0?`+${e}`:`${e}`}__webpack_require__.d(__webpack_exports__,{ce:()=>ce,qs:()=>qs,uJ:()=>qsa})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{var e,t=__webpack_require__(771),n="undefined"==typeof document?void 0:document,r=!!n&&"content"in n.createElement("template"),a=!!n&&n.createRange&&"createContextualFragment"in n.createRange();function i(e,t){var n,r,a=e.nodeName,i=t.nodeName;return a===i||(n=a.charCodeAt(0),r=i.charCodeAt(0),n<=90&&r>=97?a===i.toUpperCase():r<=90&&n>=97&&i===a.toUpperCase())}function o(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var s={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}o(e,t,"selected")},INPUT:function(e,t){o(e,t,"checked"),o(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var a=r.nodeValue;if(a==n||!n&&a==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,a=-1,i=0,o=e.firstChild;o;)if("OPTGROUP"===(r=o.nodeName&&o.nodeName.toUpperCase()))o=(n=o).firstChild;else{if("OPTION"===r){if(o.hasAttribute("selected")){a=i;break}i++}!(o=o.nextSibling)&&n&&(o=n.nextSibling,n=null)}e.selectedIndex=a}}};function d(){}function l(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}const c=function(t,o,c){if(c||(c={}),"string"==typeof o)if("#document"===t.nodeName||"HTML"===t.nodeName||"BODY"===t.nodeName){var u=o;(o=n.createElement("html")).innerHTML=u}else p=(p=o).trim(),o=r?function(e){var t=n.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(p):a?function(t){return e||(e=n.createRange()).selectNode(n.body),e.createContextualFragment(t).childNodes[0]}(p):function(e){var t=n.createElement("body");return t.innerHTML=e,t.childNodes[0]}(p);else 11===o.nodeType&&(o=o.firstElementChild);var p,f=c.getNodeKey||l,m=c.onBeforeNodeAdded||d,v=c.onNodeAdded||d,_=c.onBeforeElUpdated||d,h=c.onElUpdated||d,b=c.onBeforeNodeDiscarded||d,g=c.onNodeDiscarded||d,N=c.onBeforeElChildrenUpdated||d,w=c.skipFromChildren||d,y=c.addChild||function(e,t){return e.appendChild(t)},A=!0===c.childrenOnly,E=Object.create(null),C=[];function S(e){C.push(e)}function x(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var r=void 0;t&&(r=f(n))?S(r):(g(n),n.firstChild&&x(n,t)),n=n.nextSibling}}function k(e,t,n){!1!==b(e)&&(t&&t.removeChild(e),g(e),x(e,n))}function T(e){v(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=f(t);if(r){var a=E[r];a&&i(t,a)?(t.parentNode.replaceChild(a,t),q(a,t)):T(t)}else T(t);t=n}}function q(e,t,r){var a=f(t);if(a&&delete E[a],!r){if(!1===_(e,t))return;if(function(e,t){var n,r,a,i,o=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var s=o.length-1;s>=0;s--)r=(n=o[s]).name,a=n.namespaceURI,i=n.value,a?(r=n.localName||r,e.getAttributeNS(a,r)!==i&&("xmlns"===n.prefix&&(r=n.name),e.setAttributeNS(a,r,i))):e.getAttribute(r)!==i&&e.setAttribute(r,i);for(var d=e.attributes,l=d.length-1;l>=0;l--)r=(n=d[l]).name,(a=n.namespaceURI)?(r=n.localName||r,t.hasAttributeNS(a,r)||e.removeAttributeNS(a,r)):t.hasAttribute(r)||e.removeAttribute(r)}}(e,t),h(e),!1===N(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var r,a,o,d,l,c=w(e,t),u=t.firstChild,p=e.firstChild;e:for(;u;){for(d=u.nextSibling,r=f(u);!c&&p;){if(o=p.nextSibling,u.isSameNode&&u.isSameNode(p)){u=d,p=o;continue e}a=f(p);var v=p.nodeType,_=void 0;if(v===u.nodeType&&(1===v?(r?r!==a&&((l=E[r])?o===l?_=!1:(e.insertBefore(l,p),a?S(a):k(p,e,!0),a=f(p=l)):_=!1):a&&(_=!1),(_=!1!==_&&i(p,u))&&q(p,u)):3!==v&&8!=v||(_=!0,p.nodeValue!==u.nodeValue&&(p.nodeValue=u.nodeValue))),_){u=d,p=o;continue e}a?S(a):k(p,e,!0),p=o}if(r&&(l=E[r])&&i(l,u))c||y(e,l),q(l,u);else{var h=m(u);!1!==h&&(h&&(u=h),u.actualize&&(u=u.actualize(e.ownerDocument||n)),y(e,u),T(u))}u=d,p=o}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=f(t))?S(n):k(t,e,!0),t=r}}(e,p,a);var b=s[e.nodeName];b&&b(e,t)}(e,t):s.TEXTAREA(e,t)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var r=f(n);r&&(E[r]=n),e(n),n=n.nextSibling}}(t);var O,L,U=t,I=U.nodeType,M=o.nodeType;if(!A)if(1===I)1===M?i(t,o)||(g(t),U=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(t,(O=o.nodeName,(L=o.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==L?n.createElementNS(L,O):n.createElement(O)))):U=o;else if(3===I||8===I){if(M===I)return U.nodeValue!==o.nodeValue&&(U.nodeValue=o.nodeValue),U;U=o}if(U===o)g(t);else{if(o.isSameNode&&o.isSameNode(U))return;if(q(U,o,A),C)for(var D=0,P=C.length;D<P;D++){var R=E[C[D]];R&&k(R,R.parentNode,!1)}}return!A&&U!==t&&t.parentNode&&(U.actualize&&(U=U.actualize(t.ownerDocument||n)),t.parentNode.replaceChild(U,t)),U},u="site-jdr"===window.location.hostname?"ws://127.0.0.1:1337":"wss://web-chat.pichegru.net:443";class p{constructor(e,t,n,r,a=[],i=null){this.sender=parseInt(e),this.key=t,this.type=n,this.timestamp=Date.now(),this.content=r,this.recipients=a,this.label=i}stringify(){return JSON.stringify(this)}}const f=(0,t.qs)("#noyau"),m=f.dataset.sessionId,v=f.dataset.wsKey,_=(0,t.qs)("[name=id]").value,h=(0,t.qs)("[type=submit]"),b=new WebSocket(u);b.onopen=()=>{},b.onmessage=e=>{const t=JSON.parse(e.data);console.log(t)},(0,t.qs)("[data-role=add-portrait]").addEventListener("change",(e=>{const n=/[^\\]+\.([\w]{3,4})$/.exec(e.target.value),r=n[1];let a=n[0];["jpg","jpeg","webp","png"].includes(r)||(a="format invalide"),(0,t.qs)("#file").innerText=a}));const g=(0,t.qs)("[data-role=add-quirk]"),N=(0,t.qs)("#avdesav-wrapper");g.addEventListener("click",(e=>{console.log(e.target);const n=(0,t.ce)("div"),r=e.target.dataset.number;n.innerHTML=`\n\t\t<input hidden name="Avdesav[${r}][id]" value="0">\n\t\t<details>\n\t\t\t<summary>\n\t\t\t\t<div class="flex-s gap-½">\n\t\t\t\t\t<input type="text" name="Avdesav[${r}][nom]" class="fl-1">\n\t\t\t\t\t<input type="text" title="Coût" name="Avdesav[${r}][points]" value="-1" size="2" class="ta-center" disabled>\n\t\t\t\t</div>\n\t\t\t</summary>\n\t\t\t<div class="mt-½ fs-300">Un travers est un trait de caractère mineur ne constituant pas un désavantage. Il est possible de prendre jusqu’à 5 travers.</div>\n\t\t</details>\n\t`,N.appendChild(n),e.target.dataset.number++})),(0,t.uJ)("[data-role=close-input-modal]").forEach((e=>{e.addEventListener("click",(e=>{const t=e.target.closest("dialog");t.querySelectorAll("input").forEach((e=>e.checked=!1)),t.close()}))}));let w=!0;f.addEventListener("change",(()=>{w&&h.classList.add("clr-invalid"),w=!0})),f.addEventListener("keydown",(e=>{if(e.ctrlKey&&"s"===e.key){e.preventDefault();const t=new Event("submit",{bubbles:!0,cancelable:!0});f.dispatchEvent(t),w=!1}})),f.addEventListener("submit",(e=>{e.preventDefault(),(0,t.uJ)("dialog").forEach((e=>e.close())),fetch("/submit/update-character",{method:"post",body:new FormData(f)}).then((e=>e.text())).then((e=>{return t="main",n=e,new Promise(((e,r)=>{try{const r=(new DOMParser).parseFromString(n,"text/html").querySelector(t),a=document.querySelector(t);c(a,r,{onBeforeElUpdated:function(e,t){if("DETAILS"===e.tagName&&e.id===t.id&&(t.open=e.open),"ignore"===e.dataset.morhpdom)return!1}}),e("DOM updated successfully")}catch(e){r(e)}}));var t,n})).then((()=>{const e=new p(m,v,"character-ping",parseInt(_));b.send(e.stringify())}))}))})()})();