<?php
$nbre_protagonistes = 8;
?>

<div id="widgets-container">

	<div class="widgets-column">

		<!-- jet de d√©s simple -->
		<fieldset>
			<legend>Jet de d√©s simple</legend>
			<form class="flex-s ai-flex-between" id="simple-dice-widget">
				<div class="fl-1 ta-center">
					<input type="text" size="5" data-type="dice-expression" class="ta-center" placeholder="xd¬±y" value="3d" title="xd(y)(+-/* z)">
				</div>
				<button class="nude">üé≤</button>
			</form>
		</fieldset>

		<!-- test caract√©ristique / comp√©tence -->
		<fieldset>
			<legend>Jets de r√©ussite</legend>
			<?php for ($i = 0; $i < 7; $i++) { ?>
				<form data-role="score-tester" class="flex-s gap-¬Ω mt-¬º">
					<input type="text" class="fl-1" data-type="name" placeholder="Comp. ou carac." list="liste-carac-comp">
					<datalist id="liste-carac-comp">
						<option value="Force"></option>
						<option value="Dext√©rit√©"></option>
						<option value="Intelligence"></option>
						<option value="Sant√©"></option>
						<option value="Perception"></option>
						<option value="Volont√©"></option>
						<option value="Esquive"></option>
						<option value="Hache/Masse"></option>
						<option value="√âp√©e"></option>
						<option value="Arc"></option>
						<option value="Arbal√®te"></option>
						<option value="Combat √† mains nues"></option>
						<option value="Culture g√©n√©rale"></option>
						<option value="Furtivit√©"></option>
					</datalist>
					<input type="text" data-type="score" style="width: 7ch" class="ta-center" placeholder="score" title="score">
					<input type="text" data-type="modif" style="width: 7ch" class="ta-center" placeholder="modif" title="Modif (vide = z√©ro)">
					<button class="nude">üé≤</button>
				</form>
			<?php } ?>
		</fieldset>

		<!-- d√©g√¢ts et localisation -->
		<fieldset>
			<legend>D√©g√¢ts et localisation</legend>
			<form class="flex-s gap-¬Ω ai-first-baseline" id="weapon-damage-widget">
				<input type="text" style="width: 6ch" data-type="strength" class="ta-center" placeholder="For" title="For de l‚Äôattaquant">
				<input type="text" style="width: 8ch" data-type="weapon-code" class="ta-center" placeholder="Code" title="Code d√©g√¢ts de l‚Äôarme">
				<select id="as-mains" style="width: 14ch" data-type="hands" title="Pr√©ciser le maniement de l‚Äôarme">
					<option value="1M">1 main</option>
					<option value="2M-opt">2 mains opt.</option>
					<option value="2M">2 mains</option>
				</select>
				<div class="fl-1 fw-500 ta-center">ou</div>
				<input type="text" style="width: 8ch" data-type="dice-code" class="ta-center" placeholder="xd¬±y" title="Expression des d√©g√¢ts de type xd(y)(+-/* z)">
				<button class="nude">üé≤</button>
			</form>
		</fieldset>

		<!-- critiques & maladresses -->
		<fieldset>
			<legend>Critiques &amp; maladresses</legend>
			<form class="flex-s gap-¬Ω" id="critical-widget">
				<select class="fl-1 px-1" data-type="critical-categories">
					<option value="attack_success">R√©ussite critique en attaque</option>
					<option value="contact_weapon_miss">√âchec critique arme de contact</option>
					<option value="missile_weapon_miss">√âchec critique arme √† projectiles</option>
					<option value="throwing_weapon_miss">√âchec critique arme de jet</option>
					<option value="movement_miss">√âchec critique en mouvement</option>
					<option value="spell_miss">√âchec critique en magie</option>
				</select>
				<button class="nude">üé≤</button>
			</form>
		</fieldset>

		<!-- rafale -->
		<fieldset>
			<legend>Tir en rafale</legend>
			<form class="flex-s gap-¬Ω" id="burst-widget">
				<div class="flex-s gap-¬Ω fl-1 jc-space-between">
					<input type="text" style="width: 8ch" class="ta-center" data-type="rcl" placeholder="Rcl" title="Rcl de l‚Äôarme">
					<input type="text" style="width: 8ch" class="ta-center" data-type="fired-bullets" placeholder="Balles" title="Nombre de balles tir√©es">
					<input type="text" style="width: 8ch" class="ta-center" data-type="mr" placeholder="MR" title="Marge de r√©ussite du tir">
					<input type="text" style="width: 8ch" class="ta-center" data-type="damage-dices" placeholder="xd¬±y" title="D√©g√¢ts de chaque balle">
				</div>
				<button class="nude">üé≤</button>
			</form>
		</fieldset>

	</div>

	<div class="widgets-column desktop">
		<!-- Protagonistes -->
		<fieldset>
			<legend>Protagonistes</legend>

			<?php for ($i = 1; $i <= $nbre_protagonistes; $i++) { ?>
				<div class="grid gap-¬Ω mt-1" style="grid-template-columns: 1fr 7ch 7ch 7ch 2ch" data-role="opponent-wrapper" data-opponent="<?= $i ?>">
					<input type="text" data-type="name" placeholder="Nom" value="<?= $i === 1 ? "Mr Test" : "" ?>">
					<input type="text" data-type="san" class="center" placeholder="San" title="Sant√©" value="<?= $i === 1 ? 12 : "" ?>">
					<input type="text" data-type="pdvm" class="center" placeholder="PdVm" title="PdV maxi" value="<?= $i === 1 ? 12 : "" ?>">
					<input type="text" data-type="pdv" class="center" placeholder="PdV" title="PdV actuels" value="<?= $i === 1 ? 12 : "" ?>">
					<input type="checkbox" data-type="pain-resistance" title="R√©sistance √† la douleur">
					<input type="text" data-type="members" style="grid-column: 1/-1" placeholder="Blessures membres" title="Par exemple BD 2, PG 1">
				</div>
			<?php } ?>

		</fieldset>
	</div>

	<div class="widgets-column desktop">

		<!-- √âtat g√©n√©ral -->
		<fieldset>
			<legend>√âtat g√©n√©ral (PdV)</legend>
			<form class="flex-s gap-¬Ω" id="general-state-widget">
				<select class="fl-1 px-1" data-type="name-selector">
					<?php for ($i = 1; $i <= $nbre_protagonistes; $i++) { ?>
						<option value="<?= $i ?>">Protagoniste <?= $i ?></option>
					<?php } ?>
				</select>
				<button class="nude">üé≤</button>
			</form>
		</fieldset>

		<!-- Effet blessure -->
		<fieldset>
			<legend>Effets d‚Äôune blessure</legend>
			<form class="flex-s gap-¬Ω ai-center" id="wound-effect-widget">

				<div class="fl-1">
					<div class="flex-s gap-¬Ω">
						<select class="fl-1 px-1" data-type="name-selector">
							<?php for ($i = 1; $i <= $nbre_protagonistes; $i++) { ?>
								<option value="<?= $i ?>">Protagoniste <?= $i ?></option>
							<?php } ?>
						</select>
						<input type="text" style="width: 6ch" class="ta-center" data-type="raw-dmg" placeholder="xd¬±y" title="D√©g√¢ts bruts">
						<input type="text" style="width: 6ch" class="ta-center" data-type="rd" placeholder="RD" title="RD localisation">
					</div>

					<div class="mt-¬Ω flex-s gap-¬Ω">
						<select class="fl-1" data-type="dmg-type">
							<option value="br">Broyage</option>
							<option value="tr" selected>Tranchant</option>
							<option value="pe">Perforant</option>
							<option value="mn">Mains nues</option>
							<option value="b1">Balle</option>
							<option value="b0">Balle (‚Äì)</option>
							<option value="b2">Balle (+)</option>
							<option value="b3">Balle (++)</option>
							<option value="exp">Explosion</option>
						</select>
						<select class="fl-1" data-type="bullet-type" disabled>
							<option value="std">standard</option>
							<option value="bpa">perce-armure</option>
							<option value="bpc">pointe creuse</option>
						</select>
						<select class="fl-1" data-type="localisation">
							<option value="torse">Torse</option>
							<option value="coeur">C≈ìur</option>
							<option value="crane">Cr√¢ne</option>
							<option value="visage">Visage</option>
							<option value="cou">Cou</option>
							<option value="jambe">Jambe</option>
							<option value="bras">Bras</option>
							<option value="pied">Pied</option>
							<option value="main">Main</option>
							<option value="oeil">≈íil</option>
							<option value="org_gen">Org. g√©nitaux</option>
							<option value="oreille">Oreille</option>
						</select>
					</div>
				</div>

				<button class="nude">üé≤</button>
			</form>
		</fieldset>

		<form hidden onsubmit="return false"><!-- d√©g√¢ts objets -->
			<fieldset>
				<legend>D√©g√¢ts aux objets (exp√©rimental)</legend>
				<div class="flex-between">
					<div>
						<div>
							<input type="text" size="3" id="do_pdsm" class="center" placeholder="PdSm" title="Pts de structure maxi de l‚Äôobjet" />
							<input type="text" size="3" id="do_pds" class="center" placeholder="PdS" title="Pts de structure actuels de l‚Äôobjet" />
							<input type="text" size="3" id="do_integ" class="center" placeholder="Int√©g." title="Int√©grit√© de l‚Äôobjet" />
							<input type="text" size="3" id="do_rd" class="center" placeholder="RD" title="RD de l‚Äôobjet" />
							<input type="text" size="3" id="do_deg" class="center" placeholder="xd¬±y" title="D√©g√¢ts inflig√©s √† l‚Äôobjet" />
						</div>
						<p>
							<select id="do_type_deg" style="width: 95px" title="Type de d√©g√¢ts">
								<option value="norm">Normaux</option>
								<option value="tr-loc" selected>Localis√©s</option>
							</select>
							<select id="do_type_objet" style="width: 80px" title="Type d‚Äôobjet">
								<option value="0">&nbsp;---</option>
								<option selected>Voiture</option>
								<option>Moto</option>
								<option>Robot</option>
								<option>Quadricopt√®re</option>
							</select>

							<select id="do_orientation" style="width: 65px" title="localisation des d√©g√¢ts">
								<option>Avant</option>
								<option>Lat√©ral</option>
								<option>Arri√®re</option>
							</select>

						</p>
					</div>
					<button class="nude" onclick="calcul_degats_objet()">&#x1F3B2;</button>
				</div>
			</fieldset>
		</form>

		<form hidden onsubmit="return false"><!-- collision v√©hicule -->
			<fieldset>
				<legend>Collision de v√©hicule (exp√©rimental)</legend>
				<div class="flex-between">
					<div>
						<select id="collision_gravite" style="width: 100px">
							<option value="1">Tr√®s L√©g√®re</option>
							<option value="2">L√©g√®re</option>
							<option value="3">Moyenne</option>
							<option value="4">Grave</option>
							<option value="5">Extr√™me</option>
						</select>&emsp;
						<input type="text" size="3" id="collision_pdsm" class="center" placeholder="PdSm" />
					</div>
					<button class="nude" onclick="collision()">&#x1F3B2;</button>
				</div>
			</fieldset>
		</form>

		<form hidden onsubmit="return false"><!-- explosion -->
			<fieldset>
				<legend>Explosions</legend>
				<div class="flex-between">
					<div>
						<span style="display: inline-block; width: 40px">D√©g√¢ts</span>
						<input type="text" size="5" id="exp_degats" class="center" placeholder="xd¬±y" title="D√©g√¢ts de r√©f√©rence de l‚Äôexplosion" />
						Distance
						<input type="text" size="3" id="exp_distance" class="center" placeholder="Dist." title="Distance de la cible" onkeyup="calc_frac_explosion()" />
						<br />
						<span style="display: inline-block; width: 40px">Blast</span>
						<input type="text" size="5" id="exp_surface_blast" class="center" placeholder="Surface" title="Surface de la cible (m¬≤)" onkeyup="calc_frac_explosion()" />
						<span style="display: inline-block; width: 37px; text-align: center"><b>ou</b></span>
						<input type="text" size="5" id="exp_%_blast" class="center" placeholder="%" title="Pourcentage du blast re√ßu" /> %
						<br />
						<span style="display: inline-block; width: 40px">Frag.</span>
						<input type="text" size="5" id="exp_surface_frag" class="center" placeholder="Surface" title="Surface de la cible (m¬≤)" onkeyup="calc_frac_explosion()" />
						<span style="display: inline-block; width: 37px; text-align: center"><b>ou</b></span>
						<input type="text" size="5" id="exp_%_frag" class="center" placeholder="%" title="Pourcentage des √©clats re√ßus" /> %
						<br />
						<label for="exp_frag">Nombreux √©clats</label>
						<input type="checkbox" id="exp_frag" title="Engin explosif √† fragmentation ?" />
					</div>
					<button class="nude" onclick="calcul_deg_explosion()">&#x1F3B2;</button>
				</div>
			</fieldset>
		</form>

	</div>

</div>

<sidebar id="chat-container">

	<div id="connected-users" class="color1"></div>

	<div id="chat-dialog-wrapper">
		<p><b>Message priv√©&nbsp;:</b> "/" + n¬∞ destinataire(s) s√©par√©s par virgule ‚Äì ex. "/2,3 Coucou"</p>
	</div>

	<div id="chat-input-wrapper" data-id="<?= $_SESSION["id"] ?>" data-login="<?= $_SESSION["login"] ?>" data-key="<?= $_SESSION["id"] ? "a78D_Kj!45" : "0" ?>">

		<div class="flex-s fl-wrap gap-¬Ω fs-500 jc-center">
			<button data-role="emoji-button" class="nude">üòä</button>
			<button data-role="emoji-button" class="nude">üòÅ</button>
			<button data-role="emoji-button" class="nude">üòÑ</button>
			<button data-role="emoji-button" class="nude">üòÖ</button>
			<button data-role="emoji-button" class="nude">üòâ</button>
			<button data-role="emoji-button" class="nude">üòé</button>
			<button data-role="emoji-button" class="nude">üòè</button>
			<button data-role="emoji-button" class="nude">üòê</button>
			<button data-role="emoji-button" class="nude">üòë</button>
			<button data-role="emoji-button" class="nude">üòï</button>
			<button data-role="emoji-button" class="nude">üòî</button>
			<button data-role="emoji-button" class="nude">üòá</button>
			<button data-role="emoji-button" class="nude">üòò</button>
			<button data-role="emoji-button" class="nude">üòú</button>
			<button data-role="emoji-button" class="nude">üòÆ</button>
			<button data-role="emoji-button" class="nude">üôÑ</button>
			<button data-role="emoji-button" class="nude">üò±</button>
			<button data-role="emoji-button" class="nude">üòà</button>
			<button data-role="emoji-button" class="nude">üÉè</button>
			<button data-role="emoji-button" class="nude">üñï</button>
			<button data-role="emoji-button" class="nude">üí©</button>
		</div>

		<textarea id="msg-input" <?= !$_SESSION["id"] ? "disabled" : "" ?>></textarea>

	</div>

</sidebar>

<!-- Nouveaux scripts -->
<script type="module" src="/scripts/game-table.js"></script>

<!-- Anciens scripts √† reprendre -->
<!-- <script src="fonctions/roll_dices.js"></script>
<script src="fonctions/calculs_degats.js"></script>
<script src="fonctions/blessures_datas.js"></script>
<script src="fonctions/blessures_calculs.js"></script>
<script src="fonctions/degats_objets.js"></script> -->



<script>
	// active le type de balle si "balle" est s√©lectionn√©
	function unfreeze_bullet_type(value) {
		/* let select_bullet = document.getElementById("bl_type_balle")
		if (["b0", "b1", "b2", "b3"].includes(value)) {
			select_bullet.disabled = false
		} else {
			select_bullet.value = "std"
			select_bullet.disabled = true
		} */
	}
</script>